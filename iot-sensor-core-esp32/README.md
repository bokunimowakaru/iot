# IoT Sensor Core ESP32 by Wataru KUNINO  

ESP32-WROOM-32モジュールに対応した汎用のIoTセンサ機器向けプログラムです。  
- スマートフォンやパソコンから設定を行うことが出来ます。  
- ディープスリープに対応しています。  
- 内蔵の温度センサ、AD変換器に接続したセンサなどの読み値を送信します。  
- 単2型アルカリ乾電池2本で1年以上の動作が可能です(注意点参照)。  

## 使い方[1] ブラウザでアクセスする

本機を起動すると、無線LANアクセスポイント(AP)として動作します。スマートフォンのWi-Fi設定から「iot-core-esp32」を探して、接続してください。パスワードは「password」です。

	本機AP接続情報
		SSID=iot-core-esp32  
		PASS=password

接続後、インターネットブラウザのアドレス入力欄に[http://iot.local/](http://iot.local/)または[http://192.168.0.1/](http://192.168.0.1/)を入力すると、設定画面が表示されます。

	アクセス用URI
		http://iot.local/
		http://192.168.0.1/

APモードまたはAP+STAモードで動作しているときは、本機APへ接続した機器（スマートフォンやパソコン）から設定を行ってください。STAモードの時はLANへ接続した機器から設定を行ってください。

## 使い方[2] センサ設定

「センサ設定」画面を使って、本機に接続するセンサの設定を行ってください。

	センサ設定
		http://iot.local/sensors

## 使い方[3] ピン配列

「ピン配列」画面で、センサの接続先を確認してください。

	ピン配列の確認
		http://iot.local/pinout


--------------------------------------------------------------------------------

## 注意点

### 測定値に関する注意点
* 本機から得られた測定値は目安です。測定結果や根拠データとして使用することは出来ません。  
* 内蔵温度センサは個体差が大きいので補正が必要です。実際の室温との差を補正値へ入力してください。室温が25℃で、表示が15℃の時は、差の10℃を入力してください。  
* 本機の温度上昇とともに内蔵温度センサの測定値は上昇します。30分以上経過してから補正することで、精度を高めることができます。  

### 乾電池動作に関する注意点
* 起動時はAPモードで動作します。STAモードに比べて、起動時に多くの電力を要するので、新品の単2アルカリ乾電池を使用してください。  
* APモードでは丸1日程度しか動作しません。また、電池残量を残したまま動作しなくなります。
* 使えなくなった電池を廃棄(リサイクル)するときは、必ずマイナス極をビニールテープなどで絶縁してください。  
* 長期間の駆動を行うには、[Wi-Fi 設定]の[動作モード]をSTAモードに設定し、[スリープ設定]を[15分]〜[60分]にする必要があります。また、条件によって動作期間が大きく変化します。  

### セキュリティに関する注意点
実験用に開発したソフトウェアにつき、一例として以下のセキュリティについて注意して使用してください。
* APモード([AP+STA]モードを含む)の動作中は、「使い方」に記したSSID(iot-core-esp32)とパスワード(password)による本機へのWi-Fi接続が可能です。これらは一般公開しているので、本機のWi-Fiネットワークへ侵入したり、データ傍受することが容易な状態です。  
* 本機のAPモード([AP+STA]モードを含む)によるWi-Fiネットワークへ侵入された場合、通信内容が傍受される可能性があります。本機を[STA]モードに設定し、インターネットプロバイダから提供されている(一般的な)ルータ機能付きのWi-Fiアクセスポイントの暗号化通信機能を用いることで、侵入されにくくなります。  
* インターネットブラウザから入力したSTAモード用のSSIDとパスワードは、暗号化せずに本機へ送信されます。本機のWi-Fiネットワークへの侵入があった場合、STAモード用のSSIDとパスワードが傍受される可能性があります。APモードでの利用頻度を減らすことで、傍受されるリスクを低減することが出来ます。  
* (参考情報) ソースコード中の「SSID_AP」を未使用のSSIDに変更し、「PASS_AP」に8文字以上のパスワードを設定することで、本機のWi-Fiネットワークへの侵入リスクや傍受されるリスクを大幅に低減することも出来ます(本機を廃棄するときのことも考慮し、本機専用のSSIDとパスワードを設定して下さい)。  
* インターネットブラウザによっては、パスワード保存機能やパスワード自動入力機能、キャッシュ(戻るボタンや更新ボタンを含む)により、ブラウザに保持されたSSIDやパスワードを本機以外に送信してしまう場合があります。接続先(iot.local)が正しいかどうかを確認するなど、他のサイトへの誤送信に注意してください。  
* センサ値データの送信に暗号化されていないUDPを用いているので、ネットワークへの侵入があった場合に傍受される可能性があります。UDP送信設定を[OFF]にすることで防止することが出来ます。  
* Ambientへデータ送信するときのインターネット通信に暗号化されていないHTTPを用いているので、公衆Wi-Fiアクセスポイントを使用しているときなどに、データを傍受される可能性があります。Ambientへの送信を[OFF]にすることで防止することが出来ます。  
* 当方が作成したソフトウェアや、Espressif Systems社の提供するハードウェアやソフトウェア、Arduino IDEに含まれるソフトウェア、Wi-FiやBluetooth規格などに脆弱性が潜伏している可能性も考えられます。なるべく最新のものを使用するとともに、提供元からの更新が1年以上(目安)にわたって実施されていない場合は、使用の中止を検討してください。  

## ライセンス

* ライセンスについては各ソースリストならびに各フォルダ内のファイルに記載の通りです。  
* 使用・変更・配布は可能ですが、権利表示を残してください。  
* また、提供情報や配布ソフトによって生じたいかなる被害についても，一切，補償いたしません。  
* ライセンスが明記されていないファイルについても、同様です。  

Copyright (c) 2016-2019 Wataru KUNINO  
<https://bokunimo.net/>
